<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
// start of submission //
c.width=c.height=600;m=Math;d=[[-1,0],[0,-1],[1,0],[0,1]];i=j=2;s=o=x=0;k="#000";function g(b,e,f,w,y){a.fillStyle=y;a.fillRect(20*b,20*e,20*w,20*f)}function l(b,e){e.a?l(e,e.a):(b.a=0,g(e.x,e.y,1,1,k))}function n(b,e){return!b?0:e.x==b.x&&e.y==b.y?1:n(b.a,e)}function q(){g(p.x,p.y,1,1,k);x=++x%4;a.font=15+x+"pt Calibri";a.fillStyle="#f00";a.fillText("\u2665",20*p.x,20*(p.y+1))}function r(){p={x:m.floor(30*m.random()),y:m.floor(30*m.random())};n(s,p)||n(o,p)?r():q()} function t(b,e){var f={x:(b.x+d[e][0]+30)%30,y:(b.y+d[e][1]+30)%30,a:b};return n(s,f)||n(o,f)?0:f}function u(b,e,f){if(b=b?t(b,e):0)b.x==p.x&&b.y==p.y?r():l(b,b.a),g(b.x,b.y,1,1,f);return b}function v(){if(s=u(s,i,"#00f")){var b=99,e;for(val=j+3;val<j+6;++val){var f=t(o,val%4),f=f?m.abs(f.x-p.x)+m.abs(f.y-p.y):99;b>=f&&(b=f,e=val)}j=e%4}o=u(o,j,"#0f0");if(!s||!o)i=j=2,s={x:5,y:9,a:0},o={x:5,y:21,a:0},g(0,0,30,30,k),r();q();h=0;setTimeout(v,100)} document.addEventListener("keydown",function(b){b=b.keyCode-37;(b-i)%2&&d[b]&&!h&&(h=1,i=b)},!1);v();
// end of submission //
		</script>
	</body>
</html>
