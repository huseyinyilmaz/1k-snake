<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
// start of submission //
c.width=c.height=600;m=Math;d=[[-1,0],[0,-1],[1,0],[0,1]];i=j=2;var f,g;k=["#000","#00f","#f00","#0f0"];x=0;function h(b,e,n,o,v){a.fillStyle=k[v];a.fillRect(20*b,20*(e-1),20*o,20*n)}function l(b,e){e.a?l(e,e.a):(b.a=void 0,h(e.x,e.y,1,1,0))}function q(b,e){return!b?!1:e.x==b.x&&e.y==b.y?1:q(b.a,e)}function r(){h(p.x,p.y,1,1,0);x=++x%6;a.font=13+x+"pt Calibri";a.fillStyle=k[2];a.fillText("\u2665",20*p.x,20*p.y-1)} function s(){p={x:m.floor(30*m.random()),y:m.floor(30*m.random())+1};q(f,p)?s():r()}function t(b,e,n,o){if(b&&(b={x:(b.x+d[e][0]+30)%30,y:(b.y-1+d[e][1]+30)%30+1,a:b},b.x==p.x&&b.y==p.y?s():l(b,b.a),h(b.x,b.y,1,1,o),r(),q(b.a,b)||q(n,b)))b=0;return b}function u(){if(f=t(f,i,g,1))j%2&&p.y==g.y&&(j=0<g.x-p.x?0:2),!(j%2)&&p.x==g.x&&(j=0<g.y-p.y?1:3);g=t(g,j,f,3);if(!f||!g)i=j=2,f={x:5,y:5,a:void 0},g={x:5,y:25,a:void 0},h(0,1,30,30,0),s();changed=0;setTimeout(u,100)} document.addEventListener("keydown",function(b){b=b.keyCode-37;0!=(b-i)%2&&4>b&&0<=b&&!changed&&(changed=1,i=b)},!1);u();
// end of submission //
		</script>
	</body>
</html>
