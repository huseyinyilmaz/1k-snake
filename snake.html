<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
// start of submission //
c.width=600;c.height=600;d=[[-1,0],[0,-1],[1,0],[0,1]];i=2;s=null;k=["#000","#00f","#f00"];x=0;function f(b,e,n,o,q){a.fillStyle=k[q];a.fillRect(20*b,20*(e-1),20*o,20*n)}function g(b,e){e.a?g(e,e.a):(b.a=void 0,f(e.x,e.y,1,1,0))}function h(b,e){return!b?!1:e.x==b.x&&e.y==b.y?!0:h(b.a,e)}function j(){f(p.x,p.y,1,1,0);x=++x%5;a.font=13+x+"pt Calibri";a.fillStyle=k[2];a.fillText("\u2665",20*p.x,20*p.y)}function l(){p={x:Math.floor(30*Math.random()),y:Math.floor(30*Math.random())+1};h(s,p)?l():j()} function m(){s&&(s={x:(s.x+d[i][0])%30,y:(s.y-1+d[i][1])%30+1,a:s},0>s.x&&(s.x=29),1>s.y&&(s.y=30),s.x==p.x&&s.y==p.y?l():g(s,s.a),f(s.x,s.y,1,1,1),j(),h(s.a,s)&&(s=null));s||(i=2,s={x:5,y:1,a:void 0},f(0,1,30,30,0),l());changed=!1;setTimeout(m,100)}window.onload=function(){document.addEventListener("keydown",function(b){b=b.keyCode-37;0!=(b-i)%2&&4>b&&0<=b&&!changed&&(changed=!0,i=b)},!1);m()};
// end of submission //
		</script>
	</body>
</html>
