<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
// start of submission //
c.width=600;c.height=600;diffs=[[-1,0],[0,-1],[1,0],[0,1]];diff_index=2;s=null;colors=["#000","#00f","#f00"];function e(b,d){a.font="20pt Calibri";a.fillStyle=colors[d];a.fillText("\u2665",20*b.x,20*b.y)}function f(b,d){if(d.next)f(d,d.next);else{b.next=void 0;var j=20*d.x,k=20*(d.y-1);a.fillStyle=colors[0];a.fillRect(j,k,21,20)}}function g(b,d){return!b?!1:d.x==b.x&&d.y==b.y?!0:g(b.next,d)}function h(){p={x:Math.floor(30*Math.random()),y:Math.floor(30*Math.random())+1};g(s,p)?h():e(p,2)} function i(){s&&(s={x:(s.x+diffs[diff_index][0])%30,y:(s.y-1+diffs[diff_index][1])%30+1,next:s||null},0>s.x&&(s.x=29),1>s.y&&(s.y=30),s.x==p.x&&s.y==p.y?h():f(s,s.next),e(s,1),g(s.next,s)&&(s=null));s||(diff_index=2,s={x:5,y:1,next:null},a.fillStyle=colors[0],a.fillRect(0,0,600,600),h());changed=!1;setTimeout(i,100)}window.onload=function(){document.addEventListener("keydown",function(b){b=b.keyCode-37;0!=(b-diff_index)%2&&4>b&&0<=b&&!changed&&(changed=!0,diff_index=b)},!1);i()};
// end of submission //
		</script>
	</body>
</html>
